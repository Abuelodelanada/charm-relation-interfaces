{
    "$schema": "http://json-schema.org/draft-07/schema",
    "$id": "https://canonical.github.io/charm-relation-interfaces/interfaces/kratos_external_idp/v0/schemas/provider.json",
    "type": "array",
    "title": "Kratos external idp provider schema",
    "description": "The `kratos_external_idp` root schema comprises the entire provider databag for this interface.",
    "default": {},
    "examples": [
        {
            "client_id": "client_id",
            "client_secret": "cl1ent-s3cRet",
            "secret_backend": "relation",
            "tenant_id": "4242424242424242",
            "type": "microsoft"
        },
        {
            "client_id": "client_id_2",
            "client_secret": "pazzw0rD",
            "secret_backend": "vault",
            "tenant_id": "4242424242424242",
            "type": "microsoft"
        },
        {
            "client_id": "client",
            "client_secret": "aba",
            "secret_backend": "relation",
            "type": "google"
        }
    ],
    "required": [],
    "items": {
        "anyOf": [
            {
                "type": "object",
                "required": [
                    "client_id",
                    "client_secret",
                    "secret_backend",
                    "tenant_id",
                    "provider"
                ],
                "properties": {
                    "client_id": {"$ref": "/schemas/client_id"},
                    "client_secret": {"$ref": "/schemas/client_secret"},
                    "secret_backend": {"$ref": "/schemas/secret_backend"},
                    "tenant_id": {
                        "title": "The Azure AD tenant_id which the users belong to",
                        "description": "The Azure AD tenant_id which the users belong to",
                        "type": "string"
                    },
                    "provider": {"enum": ["microsoft"]}
                },
                "additionalProperties": true
            },
            {
                "type": "object",
                "required": [
                    "client_id",
                    "private_key",
                    "private_key_id",
                    "secret_backend",
                    "team_id",
                    "provider"
                ],
                "properties": {
                    "client_id": {"$ref": "/schemas/client_id"},
                    "private_key": {
                        "title": "The private key generated by Apple",
                        "description": "The private key generated by Apple",
                        "type": "string"
                    },
                    "private_key_id": {
                        "title": "The private key identifier generated by Apple",
                        "description": "The private key identifier generated by Apple",
                        "type": "string"
                    },
                    "secret_backend": {"$ref": "/schemas/secret_backend"},
                    "team_id": {
                        "title": "The Team ID provided by Apple",
                        "description": "The Team ID provided by Apple",
                        "type": "string"
                    },
                    "provider": {"enum": ["apple"]}
                },
                "additionalProperties": true
            },
            {
                "type": "object",
                "properties": {
                    "client_id": {
                        "$ref": "/schemas/client_id"
                    },
                    "client_secret": {
                        "$ref": "/schemas/client_secret"
                    },
                    "issuer_url": {
                        "$ref": "/schemas/issuer_url"
                    },
                    "secret_backend": {
                        "$ref": "/schemas/secret_backend"
                    },
                    "provider": {"enum": ["generic"]}
                },
                "required": [
                    "client_id",
                    "client_secret",
                    "issuer_url",
                    "secret_backend",
                    "provider"
                ],
                "additionalProperties": true
            },
            {
                "type": "object",
                "properties": {
                    "client_id": {
                        "$ref": "/schemas/client_id"
                    },
                    "client_secret": {
                        "$ref": "/schemas/client_secret"
                    },
                    "issuer_url": {
                        "$ref": "/schemas/issuer_url"
                    },
                    "secret_backend": {
                        "$ref": "/schemas/secret_backend"
                    },
                    "provider": {"enum": ["auth0"]}
                },
                "required": [
                    "client_id",
                    "client_secret",
                    "issuer_url",
                    "secret_backend",
                    "provider"
                ],
                "additionalProperties": true
            },
            {
                "type": "object",
                "properties": {
                    "client_id": {
                        "$ref": "/schemas/client_id"
                    },
                    "client_secret": {
                        "$ref": "/schemas/client_secret"
                    },
                    "secret_backend": {
                        "$ref": "/schemas/secret_backend"
                    },
                    "provider": {"enum": ["google"]}
                },
                "required": [
                    "client_id",
                    "client_secret",
                    "secret_backend",
                    "provider"
                ],
                "additionalProperties": true
            },
            {
                "type": "object",
                "properties": {
                    "client_id": {
                        "$ref": "/schemas/client_id"
                    },
                    "client_secret": {
                        "$ref": "/schemas/client_secret"
                    },
                    "secret_backend": {
                        "$ref": "/schemas/secret_backend"
                    },
                    "provider": {"enum": ["facebook"]}
                },
                "required": [
                    "client_id",
                    "client_secret",
                    "secret_backend",
                    "provider"
                ],
                "additionalProperties": true
            },
            {
                "type": "object",
                "properties": {
                    "client_id": {
                        "$ref": "/schemas/client_id"
                    },
                    "client_secret": {
                        "$ref": "/schemas/client_secret"
                    },
                    "secret_backend": {
                        "$ref": "/schemas/secret_backend"
                    },
                    "provider": {"enum": ["github"]}
                },
                "required": [
                    "client_id",
                    "client_secret",
                    "secret_backend",
                    "provider"
                ],
                "additionalProperties": true
            },
            {
                "type": "object",
                "properties": {
                    "client_id": {
                        "$ref": "/schemas/client_id"
                    },
                    "client_secret": {
                        "$ref": "/schemas/client_secret"
                    },
                    "secret_backend": {
                        "$ref": "/schemas/secret_backend"
                    },
                    "provider": {"enum": ["gitlab"]}
                },
                "required": [
                    "client_id",
                    "client_secret",
                    "secret_backend",
                    "provider"
                ],
                "additionalProperties": true
            },
            {
                "type": "object",
                "properties": {
                    "client_id": {
                        "$ref": "/schemas/client_id"
                    },
                    "client_secret": {
                        "$ref": "/schemas/client_secret"
                    },
                    "secret_backend": {
                        "$ref": "/schemas/secret_backend"
                    },
                    "provider": {"enum": ["slack"]}
                },
                "required": [
                    "client_id",
                    "client_secret",
                    "secret_backend",
                    "provider"
                ],
                "additionalProperties": true
            },
            {
                "type": "object",
                "properties": {
                    "client_id": {
                        "$ref": "/schemas/client_id"
                    },
                    "client_secret": {
                        "$ref": "/schemas/client_secret"
                    },
                    "secret_backend": {
                        "$ref": "/schemas/secret_backend"
                    },
                    "provider": {"enum": ["spotify"]}
                },
                "required": [
                    "client_id",
                    "client_secret",
                    "secret_backend",
                    "provider"
                ],
                "additionalProperties": true
            },
            {
                "type": "object",
                "properties": {
                    "client_id": {
                        "$ref": "/schemas/client_id"
                    },
                    "client_secret": {
                        "$ref": "/schemas/client_secret"
                    },
                    "secret_backend": {
                        "$ref": "/schemas/secret_backend"
                    },
                    "provider": {"enum": ["discord"]}
                },
                "required": [
                    "client_id",
                    "client_secret",
                    "secret_backend",
                    "provider"
                ],
                "additionalProperties": true
            },
            {
                "type": "object",
                "properties": {
                    "client_id": {
                        "$ref": "/schemas/client_id"
                    },
                    "client_secret": {
                        "$ref": "/schemas/client_secret"
                    },
                    "secret_backend": {
                        "$ref": "/schemas/secret_backend"
                    },
                    "provider": {"enum": ["twitch"]}
                },
                "required": [
                    "client_id",
                    "client_secret",
                    "secret_backend",
                    "provider"
                ],
                "additionalProperties": true
            },
            {
                "type": "object",
                "properties": {
                    "client_id": {
                        "$ref": "/schemas/client_id"
                    },
                    "client_secret": {
                        "$ref": "/schemas/client_secret"
                    },
                    "secret_backend": {
                        "$ref": "/schemas/secret_backend"
                    },
                    "provider": {"enum": ["netid"]}
                },
                "required": [
                    "client_id",
                    "client_secret",
                    "secret_backend",
                    "provider"
                ],
                "additionalProperties": true
            },
            {
                "type": "object",
                "properties": {
                    "client_id": {
                        "$ref": "/schemas/client_id"
                    },
                    "client_secret": {
                        "$ref": "/schemas/client_secret"
                    },
                    "secret_backend": {
                        "$ref": "/schemas/secret_backend"
                    },
                    "provider": {"enum": ["yandex"]}
                },
                "required": [
                    "client_id",
                    "client_secret",
                    "secret_backend",
                    "provider"
                ],
                "additionalProperties": true
            },
            {
                "type": "object",
                "properties": {
                    "client_id": {
                        "$ref": "/schemas/client_id"
                    },
                    "client_secret": {
                        "$ref": "/schemas/client_secret"
                    },
                    "secret_backend": {
                        "$ref": "/schemas/secret_backend"
                    },
                    "provider": {"enum": ["vk"]}
                },
                "required": [
                    "client_id",
                    "client_secret",
                    "secret_backend",
                    "provider"
                ],
                "additionalProperties": true
            },
            {
                "type": "object",
                "properties": {
                    "client_id": {
                        "$ref": "/schemas/client_id"
                    },
                    "client_secret": {
                        "$ref": "/schemas/client_secret"
                    },
                    "secret_backend": {
                        "$ref": "/schemas/secret_backend"
                    },
                    "provider": {"enum": ["dingtalk"]}
                },
                "required": [
                    "client_id",
                    "client_secret",
                    "secret_backend",
                    "provider"
                ],
                "additionalProperties": true
            }
        ]
    },
    "$defs": {
        "client_id": {
            "$id": "/schemas/client_id",
            "title": "The client_id for the Kratos client",
            "description": "The registered client_id that will be used by Kratos to authenticate with the external idp",
            "type": "string",
            "examples": [
                "some_random_string"
            ]
        },
        "client_secret": {
            "$id": "/schemas/client_secret",
            "title": "The client_secret for the Kratos client",
            "description": "The registered client_secret that will be used by Kratos to authenticate with the external idp",
            "type": "string",
            "examples": [
                "h4ckerz"
            ]
        },
        "issuer_url": {
            "$id": "/schemas/issuer_url",
            "title": "The external provider's issuer_url",
            "description": "The external provider's issuer_url",
            "type": "string",
            "examples": [
                "https://example.com/oidc"
            ]
        },
        "secret_backend": {
            "$id": "/schemas/secret_backend",
            "title": "Where the secrets are stored",
            "description": "Where the secrets are stored",
            "type": "string",
            "default": "relation",
            "enum": [
                "relation",
                "secret",
                "vault"
            ],
            "examples": [
                "relation"
            ]
        }
    }
}